<!DOCTYPE html>
<html lang="en-us"><meta charset="utf-8" />

  <title>Algebra CP Problem - Eric Xue&#39;s Web Site</title>


  <meta name="author" content="Eric Xue"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />


<link rel="stylesheet" href="https://nonrice.github.io/css/latex.css" />
<link rel="stylesheet" href="https://nonrice.github.io/css/main.css" />
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
	MathJax = {
	  tex: {
		inlineMath: [['$', '$'], ['\\(', '\\)']],
		displayMath: [['$$','$$'], ['\\[', '\\]']],
		processEscapes: true,
		processEnvironments: true
	  },
	  options: {
		skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
	  }
	};
  
	window.addEventListener('load', (event) => {
		document.querySelectorAll("mjx-container").forEach(function(x){
		  x.parentElement.classList += 'has-jax'})
	  });
  
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<style>
	a {
		color: blue !important;
	}
</style>
<meta name="generator" content="Hugo 0.124.1"><body class="latex-dark-auto">






<header>
  <nav class="navbar">
  <div class="nav">
    
    <ol class="nav-links">
      
    </ul>
  </div>
</nav>
  <div class="intro-header">
    <div class="container">
      <div class="posts-heading">
        
          <h1>Algebra CP Problem</h1>
          
        
      </div>
    </div>
  </div>
</header>
<div id="content">
  <div class="container" role="main">
    <article class="article" class="blog-post">
      <div class="postmeta">
        <span class="meta-post">
  <i class="fa fa-calendar-alt"></i>
  May 19, 2024
  
</span>
      </div>
      <br>
      
    <p>Link: <a href="https://codeforces.com/contest/1618/problem/E">https://codeforces.com/contest/1618/problem/E</a></p>
<p>Essentially the problem asks to solve a system of equations:
$$
\begin{align*}
1a_1 + 2a_2 + 3a_3 + \ldots + na_n &amp;= b_1\tag{1}\\
2a_1 + 3a_2 + 4a_3 + \ldots + 1a_n &amp;= b_2\tag{2}\\
&amp;\space\space \vdots\\
na_1 + 1a_2 + 2a_3 + \ldots + (n-1)a_n &amp;= b_n\tag{n}
\end{align*}
$$
Traditional methods to solve systems are too slow for $n\leq 2\cdot 10^5$. But the structure of the equations means such general algorithms are not needed.</p>
<p>Add the equations to get:
$$
\begin{align}
\frac{n(n+1)}{2}\sum a &amp;= \sum b\\
\sum a &amp;= \frac{2}{n(n+1)}\sum b
\end{align}
$$</p>
<p>Now there exists a procedure to compute all $a_i$. Let $i=1$ for example.</p>
<p>First subtract $(n)$ from $(1)$:
$$
\begin{align}
(1-n)a_1 + a_2 + a_3 + \ldots + a_n &amp;= b_1 - b_n\\
na_1 + \sum a &amp;= b_1 - b_n\\
a_1 &amp;= \frac{b_1 - b_n - \sum a}{n}
\end{align}
$$
From above, the value of $\sum a$ is known. So this is a closed expression for $a_1$. The general expression works out to be:
$$
a_i = \frac{b_i - b_{(i-2\bmod n) + 1} - \sum{a}}{n}
$$
Where $b_{(i-2\bmod n) + 1}$ is the equation prior to $b_i$.</p>
<p>This formula can be applied for $i\in [1, n]$ to compute the requested answer.</p>



      
    </article>
    
  </div>

        </div><footer>
  <div class="container">
    <p class="credits copyright">
      <p class="credits theme-by">
        
        
        
        <a href="https://nonrice.github.io/">Eric Xue&#39;s Web Site</a>,
        
        &copy;
        2024
        <a href="https://nonrice.github.io/about/">Eric Xue</a>
      </p>
  </div>
</footer></body>
</html>
